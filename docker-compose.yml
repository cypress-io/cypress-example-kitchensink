version: '3'

services:
  app:
    build: .
    # image: bk_cypress:latest
    environment: 
      - BUILDKITE_BUILD_CHECKOUT_PATH=.
      - BUILDKITE_BUILD_ID=${BUILDKITE_BUILD_ID}
      - BUILDKITE_PIPELINE_NAME=${BUILDKITE_PIPELINE_NAME}
      - BUILDKITE_LABEL=${BUILDKITE_LABEL}
      - BUILDKITE_BRANCH=${BUILDKITE_BRANCH}
      - BUILDKITE_COMMIT=${BUILDKITE_COMMIT}
      - BUILDKITE_PULL_REQUEST=${BUILDKITE_PULL_REQUEST}
      - BUILDKITE=${BUILDKITE}
      - BUILDKITE_PARALLEL_JOB_COUNT=${BUILDKITE_PARALLEL_JOB_COUNT}
      - BUILDKITE_PARALLEL_JOB=${BUILDKITE_PARALLEL_JOB}
      - BUILDKITE_BUILD_URL=${BUILDKITE_BUILD_URL}
      - REDEFINE_AUTH=${REDEFINE_AUTH}
      - REDEFINE_SESSION_ID=${REDEFINE_SESSION_ID}
    entrypoint:
      - /app/entrypoint.sh
